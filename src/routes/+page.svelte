<script lang="ts">
	import EditorWrapper from '$lib/components/EditorWrapper.svelte';

	const questions = [
		// Section 2 - Question 2
		{ 
			id: 'K23 q2.0', 
			title: 'K23: 2. Ariane 5 -kantoraketti',
			material: {
				url: 'https://yle.fi/plus/abitreenit/2023/kevat/2023-03-24_FY_fi/attachments/index.html#2.A',
				label: '2.A'
			},
			description: 'Ariane 5 on kantoraketti, jota k√§ytet√§√§n satelliittien laukaisemiseen.'
		},
		{ 
			id: 'K23 q2.1', 
			title: 'K23: 2.1 Laadi graafinen esitys raketin vauhdista ajan funktiona.',
			description: 'Laadi esitys siten, ett√§ siin√§ n√§kyv√§t aineiston pisteet ja ett√§ siit√§ voi lukea raketin vauhdin mill√§ tahansa ajanhetkell√§ aikav√§lill√§ 0 s ‚Äì 1 500 s.'
		},
		{ 
			id: 'K23 q2.2', 
			title: 'K23: 2.2 Kuinka pitk√§n matkan raketti kulki radallaan aikav√§lill√§ 0 s ‚Äì 1 500 s?'
		},
		{ 
			id: 'K23 q2.3', 
			title: 'K23: 2.3 Kuinka suuri oli raketin kiihtyvyys radallaan aikav√§lill√§ 700 s ‚Äì 1 400 s?'
		},

		// Section 2 - Question 3

		//question 3 is

		// { 
		// 	id: 'q3.0', 
		// 	title: '3. L√§mm√∂nsiirtokoneet',
		// 	material: { },
		// 	description: 'Valitse l√§mm√∂nsiirtokoneisiin liittyviss√§ osateht√§viss√§ 3.1‚Äì3.8 vastaus, joka kuvaa tilannetta parhaiten fysikaalisesti.'
		// },
		// { id: 'q3.1', title: '3.1 Miksi energian siirtyminen kylm√§st√§ ulkoilmasta l√§mp√∂√§ siirt√§v√§√§n aineeseen on mahdollista ulkoyksik√∂ss√§?', description: '' },
		// { id: 'q3.2', title: '3.2 Mit√§ l√§mp√∂√§ siirt√§v√§lle aineelle tapahtuu, kun se on h√∂yrystimess√§?', description: '' },
		// { id: 'q3.3', title: '3.3 L√§mp√∂pumpun s√§hk√∂teho on 1 000 W. Oikea suuruusluokka l√§mp√∂pumpun l√§mmitysteholle on...', description: '' },
		// { id: 'q3.4', title: '3.4 Mit√§ tapahtuu j√§√§kaapin s√§hk√∂nkulutukselle, jos huoneen l√§mp√∂tila pysyv√§sti nousee?', description: '' },
		// { id: 'q3.5', title: '3.5 K√§ynniss√§ olevan j√§√§kaapin ovi unohdetaan auki pitk√§ksi aikaa. Mit√§ huoneen l√§mp√∂tilalle tapahtuu?', description: '' },
		// { id: 'q3.6', title: '3.6 Mik√§ seuraavista kaavioista esitt√§√§ l√§mm√∂nsiirtokoneen toimintaperiaatetta?', description: '' },
		// { id: 'q3.7', title: '3.7 Mik√§ seuraavista graafeista esitt√§√§ ideaalisen l√§mm√∂nsiirtokoneen toimintaa? Aine on t√§ss√§ tilanteessa koko ajan kaasua.', description: '' },
		// { id: 'q3.8', title: '3.8 Er√§√§ss√§ ideaalisen l√§mm√∂nsiirtokoneen ty√∂vaiheessa aineeseen tehd√§√§n ty√∂t√§, mutta sen ja ymp√§rist√∂n v√§lill√§ ei siirry l√§mp√∂√§. Mit√§ kaasun l√§mp√∂tilalle ja tilavuudelle tapahtuu?', description: '' },

		// Section 2 - Question 4
		{ id: 'K23 q4.0', title: 'K23: 4. Kondensaattori', material: { url: 'https://yle.fi/plus/abitreenit/2023/kevat/2023-03-24_FY_fi/attachments/index.html#4.A', label: '4' }, description: 'Aineisto: 4.A Kondensaattorin varautumis- ja purkautumisk√§yr√§, 4.B T√§ydennett√§v√§ piiri, 4.C Kytkin, 4.D Vastus, 4.E J√§nnitemittari. Kondensaattoria ensin varataan ja sen j√§lkeen kondensaattorin varausta puretaan.' },
		{ id: 'K23 q4.1', title: 'K23: 4.1 T√§ydenn√§ kuvan 4.B keskener√§inen kytkent√§kaavio siten, ett√§ piirill√§ voisi tuottaa kuvan 4.A mukaisen kuvaajan. K√§yt√§ kahta kytkint√§, johtimia, vastusta sek√§ j√§nnitemittaria.', description: '' },
		{ id: 'K23 q4.2', title: 'K23: 4.2 Onko virran suunta kuvan 4.B pisteess√§ P yl√∂s- vai alasp√§in varautumisk√§yr√§n ajanhetkill√§ t‚ÇÅ ja t‚ÇÇ?', description: '' },
		{ id: 'K23 q4.3', title: 'K23: 4.3 Miten muuttaisit piirin komponentteja, jos haluat hidastaa kondensaattorin varautumista ja purkautumista?', description: '' },

		// Section 2 - Question 5
		{ id: 'K23 q5.0', title: 'K23: 5. Kynttil√§', material: { url: 'https://yle.fi/plus/abitreenit/2023/kevat/2023-03-24_FY_fi/attachments/index.html#5.A', label: '5' }, description: 'Aineisto: 5.A Mittausaineisto: Kynttil√§n pituus ajan funktiona, 5.B Valokuva maljakossa kelluvasta kynttil√§st√§, 5.C Kynttil√§n voimakuvio. Kynttil√§√§ poltetaan ja sen pituus mitataan palamisajan funktiona. Kynttil√§n pituus alussa on 189 mm, halkaisija on 21 mm ja keskim√§√§r√§inen tiheys on 862 kg/m¬≥.' },
		{ id: 'K23 q5.1', title: 'K23: 5.1 Laadi graafinen esitys kynttil√§n pituudesta ajan funktiona. Esit√§ graafissa aineiston pisteet ja mittausaineistoon sopiva malli.', description: '' },
		{ id: 'K23 q5.2', title: 'K23: 5.2 Toinen samanlainen kynttil√§ poltetaan t√§ynn√§ vett√§ olevassa maljakossa, jossa kynttil√§ kelluu. Jotta kynttil√§ pysyisi pystyss√§, sen tyveen kiinnitet√§√§n painoksi metallirengas, jonka massa on 3,5 g. Kuinka kauan kynttil√§ palaa maljakossa?', description: '' },

		// Section 2 - Question 6
		{ id: 'K23 q6.0', title: 'K23: 6. Sipsipussin rapistelu', material: { }, description: 'Yhdysvaltalainen yritys toi vuonna 2010 markkinoille biohajoavan Sun Chips -perunalastupussin. Pussin ongelmana oli voimakas rapistelu√§√§ni, jonka intensiteettitaso ylsi per√§ti 95 desibeliin. Oletetaan, ett√§ intensiteettitaso mitattiin 1,0 metrin et√§isyydelt√§.' },
		{ id: 'K23 q6.1', title: 'K23: 6.1 Mik√§ on intensiteettitaso, kun viisi ihmist√§ rapistelee kukin omaa sipsipussiaan samanaikaisesti 1,0 metrin et√§isyydell√§ mittarista?', description: '' },
		{ id: 'K23 q6.2', title: 'K23: 6.2 Tuotekehityksell√§ rapistelu√§√§nen intensiteettitaso saatiin laskettua 75 desibeliin. Kuinka monta prosenttia √§√§nen intensiteetti oli t√§ll√∂in alkuper√§isest√§ intensiteetist√§?', description: '' },
		{ id: 'K23 q6.3', title: 'K23: 6.3 Arvioi, mill√§ et√§isyydell√§ alkuper√§isen sipsipussin intensiteettitaso (95 dB) vastaa tuulen huminaa, jonka intensiteettitaso on 30 dB.', description: '' },
		{ id: 'K23 q6.4', title: 'K23: 6.4 Miksi osateht√§v√§ss√§ 6.3 laskettu et√§isyyden arvio ei ole realistinen k√§yt√§nn√∂n tilanteessa?', description: '' },

		// Section 2 - Question 7
		{ id: 'K23 q7.0', title: 'K23: 7. K√§sik√§ytt√∂inen generaattori', material: { url: 'https://yle.fi/plus/abitreenit/2023/kevat/2023-03-24_FY_fi/attachments/index.html#7.A', label: '7' }, description: 'Aineisto: 7.A Kuva: K√§sik√§ytt√∂inen generaattori, 7.B Simulaatio generaattorin tuottamasta j√§nnitteest√§. Kun kestomagneetin sis√§ll√§ oleva k√§√§mi py√∂rii tasaisella kulmanopeudella, syntyy johtimien v√§lille jaksollisesti vaihteleva j√§nnite.' },
		{ id: 'K23 q7.1', title: 'K23: 7.1 Selit√§, miten j√§nnite syntyy.', description: '' },
		{ id: 'K23 q7.2', title: 'K23: 7.2 Johda induktiolaista l√§htien lauseke |e|=NBAœâ k√§√§miin indusoituvan j√§nnitteen huippuarvolle. Lausekkeessa N on k√§√§min kierroslukum√§√§r√§, B kestomagneetin magneettivuon tiheys, A k√§√§min pinta-ala ja œâ k√§√§min kulmanopeus.', description: '' },
		{ id: 'K23 q7.3', title: 'K23: 7.3 Simulaatio generaattorin tuottamasta j√§nnitteest√§ on aineistossa 7.B. Neli√∂n muotoisessa k√§√§miss√§ on 150 kierrosta ja k√§√§min sivun pituus on 6 cm. M√§√§rit√§ simulaation avulla magneettivuon tiheys k√§√§min kohdalla.', description: '' },

		// Section 2 - Question 8
		{ id: 'K23 q8.0', title: 'K23: 8. Pieni Curie', material: { url: 'https://yle.fi/plus/abitreenit/2023/kevat/2023-03-24_FY_fi/attachments/index.html#8.A', label: '8' }, description: 'Aineisto: 8.A Artikkeli: "Marie Curie laboratoriossa ja rintamalla", 8.B Valokuva fluoroskopiakuvantamisesta ensimm√§isen maailmansodan ajalta, 8.C R√∂ntgenkuva influenssapotilaan keuhkoista vuodelta 1918. Artikkeli kuvaa ensimm√§isess√§ maailmansodassa k√§ytettyj√§ siirrett√§vi√§ r√∂ntgenkuvauslaitteita.' },
		{ id: 'K23 q8.1', title: 'K23: 8.1 Miksi r√∂ntgenlaitteita ei tuolloin voitu useinkaan kytke√§ suoraan s√§hk√∂verkkoon?', description: '' },
		{ id: 'K23 q8.2', title: 'K23: 8.2 S√§teily voitiin havaita kuvalevyll√§ tai fluoroskoopilla. Kumpaa tapaa k√§ytt√§isit itse nykyp√§iv√§n√§ ja miksi?', description: '' },
		{ id: 'K23 q8.3', title: 'K23: 8.3 Miksi aineistossa 8.A kuvattuja vammoja tai keuhkosairauksia voidaan havaita r√∂ntgenkuvantamisella?', description: '' },

		// Section 3 - Question 9
		{ id: 'K23 q9.0', title: 'K23: 9. Gammas√§teilyn ja aineen v√§linen vuorovaikutus', material: { url: 'https://yle.fi/plus/abitreenit/2023/kevat/2023-03-24_FY_fi/attachments/index.html#9.A', label: '9' }, description: 'Aineisto: 9.A Todenn√§k√∂isin fotonin vuorovaikutustapa eri energioilla ja alkuaineen j√§rjestysluvuilla, 9.B Kahden eri ilmaisimen tuottamat energiaspektrit 662 keV:n gammal√§hteelle. Gammafotoni eli korkeaenergiainen fotoni vuorovaikuttaa aineen kanssa kolmella eri tavalla.' },
		{ id: 'K23 q9.1', title: 'K23: 9.1 Mit√§ fotonille tapahtuu, ja mihin sen energia siirtyy valos√§hk√∂ilmi√∂ss√§ ja parinmuodostuksessa?', description: '' },
		{ id: 'K23 q9.2', title: 'K23: 9.2 Comptonin ilmi√∂ss√§ fotoni siroaa elektronista. Mik√§ on suurin liike-energia, jonka elektroni voi saada fotonilta, kun 662 keV:n fotoni siroaa siit√§?', description: '' },
		{ id: 'K23 q9.3', title: 'K23: 9.3 Kahdella erilaisella tilavuudeltaan pienell√§ ilmaisimella havaittiin Cs-137-s√§teilyl√§hteen tuottamaa 662 keV:n gammas√§teily√§. Selit√§, mit√§ on todenn√§k√∂isimmin tapahtunut ilmaisimissa, kun spektreihin on ilmaantunut tapahtumia alle 400 keV:n alueelle. Kumpi kuvan 9.B spektreist√§ (A/B) on muovista valmistetun ilmaisimen spektri?', description: '' },

		// Section 3 - Question 10
		{ id: 'K23 q10.0', title: 'K23: 10. Parafiinin sulamisl√§mp√∂', material: { url: 'https://yle.fi/plus/abitreenit/2023/kevat/2023-03-24_FY_fi/attachments/index.html#10.A', label: '10' }, description: 'Aineisto: 10.A Piirrospohja. Haluat kokeellisesti m√§√§ritt√§√§ materiaalin ominaissulamisl√§mm√∂n fysiikan oppitunnilla. Olet valinnut materiaaliksi parafiinin, jonka sulamispiste on 60 ¬∞C. K√§ytett√§viss√§: solupolystyreeniastia, vett√§ ja vedenkeitin, kiinte√§t√§ parafiinia 20 ¬∞C:ssa, sek√§ fysiikan luokan mittausv√§lineet.' },
		{ id: 'K23 q10.1', title: 'K23: 10.1 Mitk√§ ovat ty√∂n p√§√§vaiheet ja niiss√§ teht√§v√§t mittaukset? Miten m√§√§rit√§t mittaustuloksista parafiinin ominaissulamisl√§mm√∂n? Esit√§ tarvittavat suureyht√§l√∂t. Mitk√§ numeroidun listan v√§lineist√§ tarvitset?', description: '' },
		{ id: 'K23 q10.2', title: 'K23: 10.2 Vertaat lopuksi mittauksista saamaasi sulamisl√§mm√∂n arvoa kirjallisuusarvoon. Luettele kolme t√§rke√§t√§ tekij√§√§, jotka aiheuttavat mittaamaasi arvoon poikkeaman kirjallisuusarvosta.', description: '' },

		// Section 3 - Question 11
		{ id: 'K23 q11.0', title: 'K23: 11. James Webb -avaruusteleskooppi', material: { url: 'https://yle.fi/plus/abitreenit/2023/kevat/2023-03-24_FY_fi/attachments/index.html#11.A', label: '11' }, description: 'Aineisto: 11.A James Webb -avaruusteleskooppi, 11.B Aurinko-Maa-j√§rjestelm√§n Lagrangen piste L2. Joulup√§iv√§n√§ 2021 laukaistiin James Webb -avaruusteleskooppi Lagrangen pisteeseen L2. Teleskooppi kiert√§√§ Aurinkoa pysyen Auringon ja Maan kautta kulkevalla suoralla. Teleskooppi toimii l√§hinn√§ infrapuna-alueella.' },
		{ id: 'K23 q11.1', title: 'K23: 11.1 Miksi alhainen l√§mp√∂tila on olennainen tekij√§ infrapunas√§teilyn havainnoinnissa?', description: '' },
		{ id: 'K23 q11.2', title: 'K23: 11.2 Miksi kuvassa 11.A n√§kyv√§ teleskoopin l√§mp√∂suoja ei ole yhten√§inen kerros, vaan koostuu viidest√§ erill√§√§n olevasta kerroksesta?', description: '' },
		{ id: 'K23 q11.3', title: 'K23: 11.3 Piirr√§ teleskoopin voimakuvio ja nime√§ voimat.', description: '' },
		{ id: 'K23 q11.4', title: 'K23: 11.4 Teleskoopin et√§isyys Maasta on 1,5 miljoonaa kilometri√§. Perustele t√§m√§ osoittamalla, ett√§ Newtonin II laki toteutuu kyseisell√§ et√§isyyden arvolla.', description: '' },
	];

	let currentQuestionIndex = 0;
	$: currentQuestion = questions[currentQuestionIndex];
	
	function nextQuestion() {
		if (currentQuestionIndex < questions.length - 1) {
			currentQuestionIndex++;
		}
	}
	
	function previousQuestion() {
		if (currentQuestionIndex > 0) {
			currentQuestionIndex--;
		}
	}
	
	function goToQuestion(index: number) {
		currentQuestionIndex = index;
	}

	const excludedCmds = [
		'searchAndReplace', 'bulletList', 'alignLeft', 'alignRight', 
		'audio-placeholder', 'taskList', 'orderedList', 'alignJustify', 
		'video-placeholder', 'iframe-placeholder', 'underline', 'subscript', 
		'heading1', 'heading2', 'bold', 'alignCenter', 'font increment', 'undo', 'redo', 'italic'
	];
</script>

<div class="container">
	<h1>Fysiikan Yo Kone</h1>
	<p class="subtitle">Question {currentQuestionIndex + 1} of {questions.length}</p>

	<!-- Progress bar -->
	<div class="progress-container">
		<div class="progress-bar" style="width: {((currentQuestionIndex + 1) / questions.length) * 100}%"></div>
	</div>

	<!-- Question card -->
	<div class="question-card">
		<div class="question-header">
			<h3 class="question-title">
				{currentQuestion.title}
				{#if currentQuestion.material && currentQuestion.material.url}
					<a href={currentQuestion.material.url} target="_blank" rel="noopener noreferrer" class="material-link">
						üìé Aineisto {currentQuestion.material.label}
					</a>
				{/if}
			</h3>
			{#if currentQuestion.description}
				<p class="question-description">{currentQuestion.description}</p>
			{/if}
		</div>
		
		<div class="editor-container">
			{#key currentQuestion.id}
				<EditorWrapper 
					editorId={currentQuestion.id}
					excludedCommands={excludedCmds} 
					imagexasizewidth={500} 
					imagemaxsizeheight={350} 
				/>
			{/key}
		</div>
	</div>

	<!-- Navigation buttons -->
	<div class="navigation">
		<button 
			class="nav-button" 
			on:click={previousQuestion} 
			disabled={currentQuestionIndex === 0}
		>
			‚Üê Previous
		</button>
		
		<div class="question-selector">
			<select bind:value={currentQuestionIndex} class="question-dropdown">
				{#each questions as question, index}
					<option value={index}>
						{question.id.toUpperCase()} - {question.title.split('.')[0]}.{question.title.split('.')[1]?.split(' ')[0] || ''}
					</option>
				{/each}
			</select>
		</div>
		
		<button 
			class="nav-button" 
			on:click={nextQuestion} 
			disabled={currentQuestionIndex === questions.length - 1}
		>
			Next ‚Üí
		</button>
	</div>

	<!-- Question grid for quick navigation -->
	<div class="question-grid">
		{#each questions as question, index}
			<button 
				class="question-number" 
				class:active={index === currentQuestionIndex}
				on:click={() => goToQuestion(index)}
				title={question.title}
			>
				{question.id.replace('q', '')}
			</button>
		{/each}
	</div>
</div>

<style>
	:global(body) {
		font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
		background-color: #f5f5f5;
		margin: 0;
		padding: 0;
	}

	.container {
		max-width: 1000px;
		margin: 0 auto;
		padding: 20px;
	}

	h1 {
		text-align: center;
		margin-bottom: 10px;
	}

	.subtitle {
		text-align: center;
		color: #666;
		margin-bottom: 20px;
	}

	.progress-container {
		width: 100%;
		height: 6px;
		background-color: #e0e0e0;
		border-radius: 3px;
		margin-bottom: 30px;
		overflow: hidden;
	}

	.progress-bar {
		height: 100%;
		background: linear-gradient(90deg, #4CAF50, #45a049);
		transition: width 0.3s ease;
	}

	.question-card {
		background: white;
		border-radius: 8px;
		padding: 30px;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
		margin-bottom: 20px;
		min-height: 400px;
	}

	.question-header {
		margin-bottom: 20px;
	}

	.question-title {
		margin-top: 0;
		margin-bottom: 10px;
		color: #333;
		font-size: 1.1rem;
		line-height: 1.6;
		display: flex;
		align-items: center;
		flex-wrap: wrap;
		gap: 10px;
	}

	.question-description {
		color: #666;
		font-size: 0.95rem;
		margin: 0;
		line-height: 1.5;
	}

	.material-link {
		color: #1976d2;
		text-decoration: none;
		font-weight: 500;
		padding: 4px 12px;
		background-color: #e3f2fd;
		border-radius: 4px;
		font-size: 0.9rem;
		transition: all 0.2s ease;
		white-space: nowrap;
	}

	.material-link:hover {
		background-color: #bbdefb;
		color: #1565c0;
		transform: translateY(-1px);
	}

	.editor-container {
		width: auto;
		height: auto;
		border: 1px solid #ddd;
		border-radius: 4px;
	}

	.navigation {
		display: flex;
		justify-content: space-between;
		align-items: center;
		gap: 20px;
		margin-bottom: 30px;
	}

	.nav-button {
		padding: 12px 24px;
		font-size: 16px;
		font-weight: 500;
		background-color: #4CAF50;
		color: white;
		border: none;
		border-radius: 4px;
		cursor: pointer;
		transition: all 0.2s ease;
		min-width: 120px;
	}

	.nav-button:hover:not(:disabled) {
		background-color: #45a049;
		transform: translateY(-1px);
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
	}

	.nav-button:disabled {
		background-color: #cccccc;
		cursor: not-allowed;
		opacity: 0.6;
	}

	.question-selector {
		flex: 1;
		max-width: 400px;
	}

	.question-dropdown {
		width: 100%;
		padding: 10px 15px;
		font-size: 14px;
		border: 2px solid #ddd;
		border-radius: 4px;
		background-color: white;
		cursor: pointer;
		transition: border-color 0.2s ease;
	}

	.question-dropdown:hover {
		border-color: #4CAF50;
	}

	.question-dropdown:focus {
		outline: none;
		border-color: #4CAF50;
		box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
	}

	.question-grid {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
		gap: 8px;
		padding: 20px;
		background: white;
		border-radius: 8px;
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
	}

	.question-number {
		padding: 10px;
		border: 2px solid #e0e0e0;
		border-radius: 4px;
		background: white;
		cursor: pointer;
		font-size: 13px;
		font-weight: 500;
		transition: all 0.2s ease;
	}

	.question-number:hover {
		border-color: #4CAF50;
		background-color: #f1f8f4;
	}

	.question-number.active {
		background-color: #4CAF50;
		color: white;
		border-color: #4CAF50;
	}

	/* Responsive design */
	@media (max-width: 768px) {
		.container {
			padding: 10px;
		}

		.question-card {
			padding: 20px;
		}

		.navigation {
			flex-direction: column;
		}

		.question-selector {
			max-width: 100%;
			width: 100%;
		}

		.nav-button {
			width: 100%;
		}

		.question-grid {
			grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
		}

		.question-title {
			font-size: 1rem;
		}
	}
</style>